/**
 * ============================================================================
 * TitleBar Component Styles
 * ============================================================================
 * 
 * Custom window titlebar styling with:
 * - Draggable by default across the entire bar (~75%+ draggable area)
 * - Interactive elements (menus, buttons) explicitly excluded from drag
 * - Logo and menu sections on the left
 * - Centered application title
 * - Window controls on the right
 * 
 * DRAG REGION STRATEGY (Modern Approach):
 * - The entire .titlebar is set as a drag region
 * - Interactive child elements (buttons, menus) use app-region: no-drag
 * - This maximizes the draggable area while keeping buttons clickable
 * - User can grab anywhere except directly on interactive elements
 * ============================================================================
 */

/* =============================================================================
 * TITLEBAR CONTAINER
 * Main header bar layout - three-column design
 * ============================================================================= */

.titlebar {
    /* Full height from parent grid cell */
    height: 100%;

    /* Horizontal padding for content */
    padding: 0;
    padding-left: var(--space-2, 8px);

    /* Three-section layout with centered title */
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: var(--space-2, 8px);

    /* Background */
    /* background: var(--panel-bg); -- Moved to workbench for better blending */
    background: transparent;
    border-bottom: 1px solid var(--border);
    color: var(--text);

    /* Ensure crisp rendering */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;

    /* =========================================================================
     * DRAG REGION: Make the ENTIRE titlebar draggable by default
     * =========================================================================
     * This approach (used by VS Code, Electron apps) makes ~75%+ of the
     * titlebar draggable. Interactive elements below explicitly opt-out
     * using app-region: no-drag.
     * ========================================================================= */
    -webkit-app-region: drag;
    app-region: drag;

    /* Prevent text selection while dragging */
    user-select: none;
}

/* =============================================================================
 * LEFT SECTION
 * Logo and menu items - NOT draggable
 * ============================================================================= */

.titlebar-left {
    display: flex;
    align-items: center;
    gap: var(--space-1, 4px);
    justify-self: start;

    /* Explicitly no drag to be safe */
    -webkit-app-region: no-drag;
    app-region: no-drag;
}

/* Logo */
.titlebar-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-1, 4px) var(--space-2, 8px);

    /* Subtle hover effect */
    border-radius: var(--radius-sm, 4px);
    transition: background var(--transition-fast);
}

.titlebar-logo:hover {
    background: var(--panel-bg-hover);
}

.titlebar-logo-icon {
    font-size: var(--text-lg, 16px);
    transition: transform var(--transition-normal);
}

.titlebar-logo:hover .titlebar-logo-icon {
    transform: rotate(-10deg) scale(1.1);
}

/* =============================================================================
 * MENU NAVIGATION
 * File, Edit, Selection, View, Tools, Help sections
 * ============================================================================= */

.titlebar-menu {
    display: flex;
    align-items: center;
    gap: 0;
}

.titlebar-menu-section {
    position: relative;
}

.titlebar-menu-trigger {
    /* Reset button styles */
    appearance: none;
    border: none;
    background: transparent;
    font-family: inherit;
    cursor: pointer;

    /* Typography */
    font-size: var(--text-sm, 12px);
    color: var(--text-muted);

    /* Sizing */
    padding: var(--space-1, 4px) var(--space-2, 8px);
    border-radius: var(--radius-sm, 4px);

    /* Transitions */
    transition:
        background var(--transition-fast),
        color var(--transition-fast);

    /* =========================================================================
     * CRITICAL: Exclude from drag region so clicks are received
     * Parent .titlebar-left already has no-drag, but being explicit here
     * ensures reliability across browser/Tauri versions.
     * ========================================================================= */
    -webkit-app-region: no-drag;
    app-region: no-drag;
}

.titlebar-menu-trigger:hover,
.titlebar-menu-section.active .titlebar-menu-trigger {
    background: var(--panel-bg-hover);
    color: var(--text);
}

/* =============================================================================
 * DROPDOWN MENUS
 * Popup menus for each section
 * ============================================================================= */

.titlebar-dropdown {
    /* Positioning */
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 2px;

    /* Sizing */
    min-width: 220px;
    max-height: 70vh;
    overflow-y: auto;

    /* Appearance */
    background: var(--panel-bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-md, 6px);
    box-shadow: var(--shadow-lg);

    /* Stacking */
    z-index: var(--z-dropdown, 300);

    /* Animation */
    animation: titlebar-dropdown-enter 0.1s ease-out;
}

@keyframes titlebar-dropdown-enter {
    from {
        opacity: 0;
        transform: translateY(-4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.titlebar-dropdown-item {
    /* Reset button styles */
    appearance: none;
    border: none;
    background: transparent;
    font-family: inherit;
    cursor: pointer;
    width: 100%;
    text-align: left;

    /* Layout */
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4, 16px);

    /* Sizing */
    padding: var(--space-2, 8px) var(--space-3, 12px);

    /* Typography */
    font-size: var(--text-sm, 12px);
    color: var(--text);

    /* Transitions */
    transition: background var(--transition-fast);
}

.titlebar-dropdown-item:hover {
    background: var(--panel-bg-hover);
}

.titlebar-dropdown-item.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.titlebar-dropdown-label {
    flex: 1;
}

.titlebar-dropdown-shortcut {
    color: var(--text-subtle);
    font-size: var(--text-xs, 11px);
    font-family: var(--font-mono);
}

.titlebar-dropdown-divider {
    height: 1px;
    margin: var(--space-1, 4px) var(--space-2, 8px);
    background: var(--divider);
}

/* =============================================================================
 * CENTER SECTION
 * Application title - inherits drag from parent .titlebar
 * ============================================================================= */

.titlebar-center {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2, 8px);
    justify-self: stretch;
    width: 100%;
    height: 100%;

    /* Inherits drag from parent .titlebar, no need to set here */
    /* Prevent text selection */
    user-select: none;
}

.titlebar-title {
    /* Brand typography */
    font-size: var(--text-sm, 13px);
    font-weight: var(--font-semibold, 600);
    letter-spacing: 0.5px;

    /* Gradient brand text for premium feel */
    background: linear-gradient(135deg,
            var(--accent, #7aa2f7) 0%,
            var(--accent-secondary, #bb9af7) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}

.titlebar-subtitle {
    font-size: var(--text-sm, 12px);
    color: var(--text-subtle);
    font-weight: var(--font-normal, 400);
}

/* =============================================================================
 * RIGHT SECTION
 * Window controls
 * ============================================================================= */

.titlebar-right {
    display: flex;
    align-items: center;
    justify-self: end;
    height: 100%;

    /* CRITICAL: Explicitly no drag so buttons receive clicks */
    -webkit-app-region: no-drag;
    app-region: no-drag;
}